storage:
  files:
    - path: "/etc/hostname"
      filesystem: root
      mode: 0644
      contents:
        inline: |
          __HOST_NAME__

    - path: "/etc/hosts"
      filesystem: root
      mode: 0644
      contents:
        inline: |
          127.0.0.1	localhost
          ::1		localhost

    - path: "/etc/sabakan.yml"
      filesystem: root
      contents:
        inline: |
          advertise-url: http://__HOST__:10080
          advertise-url-https: http://__HOST__:10443
          allow-ips: [0.0.0.0/0]
          dhcp-bind: 0.0.0.0:67
          etcd:
            endpoints: [http://__HOST1__:2379]
      mode: 0644
    - path: "/etc/sabakan/sabakan-tls.crt"
      filesystem: root
      mode: 0644
      contents:
        inline: |
          -----BEGIN CERTIFICATE-----
          MIID2jCCAsKgAwIBAgIURDoNhBD/wjaJVE83uuvaQnaPWYowDQYJKoZIhvcNAQEL
          BQAwUzEOMAwGA1UEBhMFSmFwYW4xDjAMBgNVBAgTBVRva3lvMRUwEwYDVQQKEwxD
          eWJvenUsIEluYy4xDTALBgNVBAsTBE5lY28xCzAJBgNVBAMTAmNhMB4XDTE4MDgw
          MjA0NTAwMFoXDTI4MDczMDA0NTAwMFowXDEOMAwGA1UEBhMFSmFwYW4xDjAMBgNV
          BAgTBVRva3lvMRUwEwYDVQQKEwxDeWJvenUsIEluYy4xDTALBgNVBAsTBE5lY28x
          FDASBgNVBAMTC2V4YW1wbGUuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIB
          CgKCAQEAsPpcApp6mY7zN0ZRdRoHqpOagj94jlpWGfFJtjfhUFjEHUBV/YWkylcj
          vqTCuf9Y9hRc+e3sIqcaEcDx6pW249k3SBio5O1Q+nNiHkPswLj1uXwMOuFgz28T
          IGUFVgykVw5sWtCFZ0CNJhRdoT5sqxVRewJ67slGJ9+gnvOT8tPYhcKdvq87tCzb
          Onxa1iE7DEmVoAAv32Ad+n5J1QcEv1Gx/CdCQZrBdxY/5xCINQ4frjTkhEgCrP3F
          ZdIr57ykJKsxSUyEQetZVRHIB+51FVQrbkLKZi/coaEhduYpGQHEnrKmLrTT+P2n
          Fyi6VW/cNlSZHhRiq4ED13OSQ+dVtwIDAQABo4GcMIGZMA4GA1UdDwEB/wQEAwIF
          oDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAd
          BgNVHQ4EFgQUoLHrxN4T+K76l1cjF0kWzMFJHW8wHwYDVR0jBBgwFoAU12dcKEHA
          Mz2JJZXbE2QnLkThBUgwGgYDVR0RBBMwEYIJbG9jYWxob3N0hwR/AAABMA0GCSqG
          SIb3DQEBCwUAA4IBAQCpvgz+jcwIDyBOB1ibQ5kGtQ4mg9X1SzcZuQv9oOy/piKI
          4l1msspNhOBOGt/dhWQkvi2zXMEcbJEMdN0LdXYx7pwBHjnrwkRKH73fIuZlliG6
          7so/BKAD4bUIefVOv+Z6/jr+w5t73Egd7evN2ZGMDngIO6gho8WfVz4Bk6qifirD
          6+MG+t88+Z7tB0za7a4amUav0/fivS3q4Buqby8qmwMUOBUh+PiWrrP9vhagOIMb
          5oHLdff9SE3wAQFoQsKgo685jGMJ8qRfn6CNXbSY5lpd7BRatQVhFammxVUsLnHo
          WQkLSHHsZaNiU8UmxQFYiFGpFqRJ9euAJhi1ocPF
          -----END CERTIFICATE-----

    - path: "/etc/sabakan/sabakan-tls.key"
      filesystem: root
      mode: 0644
      contents:
        inline: |
          -----BEGIN RSA PRIVATE KEY-----
          MIIEowIBAAKCAQEAsPpcApp6mY7zN0ZRdRoHqpOagj94jlpWGfFJtjfhUFjEHUBV
          /YWkylcjvqTCuf9Y9hRc+e3sIqcaEcDx6pW249k3SBio5O1Q+nNiHkPswLj1uXwM
          OuFgz28TIGUFVgykVw5sWtCFZ0CNJhRdoT5sqxVRewJ67slGJ9+gnvOT8tPYhcKd
          vq87tCzbOnxa1iE7DEmVoAAv32Ad+n5J1QcEv1Gx/CdCQZrBdxY/5xCINQ4frjTk
          hEgCrP3FZdIr57ykJKsxSUyEQetZVRHIB+51FVQrbkLKZi/coaEhduYpGQHEnrKm
          LrTT+P2nFyi6VW/cNlSZHhRiq4ED13OSQ+dVtwIDAQABAoIBAGOj8V2937zJEQJT
          4tTNXPeatukSFyv+jG96vAeNmpuD/paBfGiKb+dD/Gn/lWrm6w1RFa/ZVpOEBVdt
          jEaJGDlcOJWs3JpXSrpXcCyeDZPMDvzpbHFSJxFi9h/NAJ4b7ALfqf3PXOxvGYkQ
          +k4oOUJxdDiPgusiAw+8BlC3ztptn88h4iubh40kHmZXRmwO3rZNvsVAWouHRKYf
          kEOQYP2L9Qxgk89HcboaYM7d3dxb1gZKhCwfXNHEgiKI37lza7N2sOkdusgZM6Tq
          TDZwCIygzREi6UA3/u5x/XOTTSOwYIrxARnZ+1qyWRLilSXvgUBdtcnQl6BYTFKS
          Vn138+ECgYEA0rx0MG/V4MXLBao/UY3oc8nM1YEoR2tqpoggT2RevVRsUv3RJOje
          uZ0RRtbP9a02kFQUWVd5e0usYEBUx1GxUg5aSj6O3ta3OJOvLthQIYOxjg9U8sQN
          x1yn+2pVQn2CnZOvbHk251lElHylBG0CK0yX5bCddUDKMsxZcaBw14kCgYEA1v2t
          RmAOtvBa2Ae6SloLKYy/vJ3mIeaauscbXs/XxeKAVcqUxxuS6KlMu9VimvrHoKeX
          9URmOsa6pVuV8BuioaWDumBL3OkS4fOPvkyoz1bKjV9DIs5gFlzR4Ug96rU2Ynqi
          kHTSYTTEog9W9b+LhDSFxztpLhnGgXxXGwUiMz8CgYBJ36JjcHDrcKrw+3Ni5Xo9
          TNqvZa13C+LBKisZabgEatnmZe+xHqklLDhoOtl/6A6enbrcbtu5KxfsTeDqVmrw
          tvNT34Y5+88S2EKrC01b0kyl3h4LVEr4PjTs36OvwUvObX0ra3qhsxtlaiR23rfJ
          8fm1nSo1dlbrY9NfD70+8QKBgD3x27IyTSsSt+oU1+1CYoL3ReuPx1YvPpfgdJdt
          5Wrj5zxQ4Ws5G6wj07MvOXkUFt7ISzVlHtuClRa9+8ax/7r5mKnjwxgEo+csqVcY
          eW88P6JaN1rZAcCPv/1cNlLhIalgUmSy9EcD0EAtkU2/gfB2vbD5AkZBMPvwGpzz
          brY7AoGBAIZ+XVewRA64uDVl/tn8bHdz5Zl+spAnOhaFgvS8RdzkJ5A+4+dQf7VJ
          j3g69L7A6Eey8J2PZdG2YJ7ou9MXNv/1fsfRDMNfXUV8jcOr7z/1OMysqOCS1B/c
          VtLtJG+DMKg1cNzH81xqNY8rBYfbfkrY3TcEa5DZkc8aTrzR4Tjc
          -----END RSA PRIVATE KEY-----

  directories:
    - filesystem: root
      path: "/opt/bin"
      mode: 0755

networkd:
  units:
    - name: 00-eth0.network
      contents: |
        [Match]
        Name=eth0

        [Network]
        Address=__HOST_ADDRESS__/24
        Gateway=__BRIDGE_ADDRESS__
        DNS=8.8.8.8
        DNS=1.1.1.1

passwd:
  users:
    - name: cybozu
      password_hash: "$6$rounds=4096$m3AVOWeB$EPystoHozf.eJNCm4tWyRHpJzgTDymYuGOONWxRN8uk4amLvxwB4Pc7.tEkZdeXewoVEBEX5ujUon9wSpEf1N."
      ssh_authorized_keys:
        - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDfQ2R2DS2LgjTxs+Z27hfWF4eGH2/ymeXvvUWmc5hRgC//RVnk9b2Tcix/pALNvzUqK9nTbk2F3Gn/PziBWFDSHbhYeHBRlkctu9gInLbL+VVNWmhhPDstgrUE9I+EDAB9hm958xRBBFzzpABLB7oXxeYz8RIuuDWY8I0or9q8Z/v4ZvR+hSsQI64A45obnIdp3ak/0WgyZQYtvnLGpTowDtlxz2wpIHZy9AZa/h5WC6q032o6/SzHZva0hDnQ3q2++icT8Ugm1shRaxIz9eu25z2yItEkV3FoTODRNAwzKtrrt+MwdmCabzAzObRQREXtFghZ2TqTi1FTbkPPT/7d mtest
      groups:
        - docker
        - sudo

systemd:
  units:
    - name: update-engine.service
      mask: true

    - name: locksmithd.service
      mask: true

    - name: ignitions.mount
      enable: true
      contents: |
        [Mount]
        What=ignitions
        Where=/ignitions
        Type=9p
        Options=ro

        [Install]
        WantedBy=local-fs.target
